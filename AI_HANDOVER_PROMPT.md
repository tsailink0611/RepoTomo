# RepoTomo AIé–‹ç™ºå¼•ãç¶™ããƒ—ãƒ­ãƒ³ãƒ—ãƒˆ

## ğŸ¯ ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦

### ã‚·ã‚¹ãƒ†ãƒ å
**RepoTomoï¼ˆãƒ¬ãƒãƒ¼ãƒˆãƒ¢ï¼‰** - å¿ƒç†çš„å®‰å…¨æ€§ã‚’æœ€é‡è¦–ã—ãŸå ±å‘Šæ›¸ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ 

### ã‚³ã‚¢ã‚³ãƒ³ã‚»ãƒ—ãƒˆ
**ã€Œå ±å‘Šæ›¸ã¯æå‡ºã—ã¦ã‚‚ã‚‰ã†ã‚‚ã®ã§ã¯ãªãã€ã‚¹ã‚¿ãƒƒãƒ•ãŒè‡ªç„¶ã«å‡ºã—ãŸããªã‚‹ã‚‚ã®ã€**

### å¯¾è±¡
- é£²é£Ÿãƒã‚§ãƒ¼ãƒ³ï¼ˆ120åè¦æ¨¡ï¼‰
- ã‚¹ã‚¿ãƒƒãƒ•ã®å¿ƒç†çš„è² æ‹…ã‚’æœ€å°é™ã«ã—ãªãŒã‚‰ã€ç®¡ç†è€…ãŒå¿…è¦ãªæƒ…å ±ã‚’åŠ¹ç‡çš„ã«åé›†

### æœ€é‡è¦ç‰¹å¾´
- **æœˆé¡0å††ã€œæ•°ç™¾å††**ã§é‹ç”¨å¯èƒ½ãªè¶…ä½ã‚³ã‚¹ãƒˆè¨­è¨ˆ
- **å¿ƒç†çš„å®‰å…¨æ€§**ã‚’æœ€å„ªå…ˆã—ãŸUI/UX
- **ãƒ—ãƒ¬ãƒƒã‚·ãƒ£ãƒ¼ã‚’ä¸ãˆãªã„**é‹ç”¨ãƒ•ãƒ­ãƒ¼

## ğŸ’° æŠ€è¡“æ§‹æˆãƒ»ã‚³ã‚¹ãƒˆæˆ¦ç•¥

### ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ï¼ˆå®Œå…¨ç„¡æ–™ãƒ—ãƒ©ãƒ³ï¼‰
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Cloudflare    â”‚    â”‚     Vercel      â”‚    â”‚    Supabase     â”‚
â”‚ (CDN/DNS) ç„¡æ–™  â”‚â”€â”€â”€â–¶â”‚ (Frontend) ç„¡æ–™ â”‚â”€â”€â”€â–¶â”‚ (Backend) ç„¡æ–™  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚                        â”‚
                              â–¼                        â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ Service Worker  â”‚    â”‚ Edge Functions  â”‚
                    â”‚  (PWA Cache)    â”‚    â”‚ (Serverless)    â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯
#### ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰
- **React 18** + **TypeScript** + **Vite**
- **Tailwind CSS**ï¼ˆæš–è‰²ç³»ãƒ‘ã‚¹ãƒ†ãƒ«ã‚«ãƒ©ãƒ¼ï¼‰
- **PWAå¯¾å¿œ**ï¼ˆVite PWA Pluginï¼‰
- **Zustand**ï¼ˆçŠ¶æ…‹ç®¡ç†ï¼‰
- **React Query**ï¼ˆã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ»åŒæœŸï¼‰

#### ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰
- **Supabase**ï¼ˆPostgreSQL + Auth + Edge Functions + Realtimeï¼‰
- **Row Level Security (RLS)**
- **Edge Functions**ï¼ˆTypeScript/Denoï¼‰

#### ã‚¤ãƒ³ãƒ•ãƒ©ãƒ»ãƒ‡ãƒ—ãƒ­ã‚¤
- **Vercel**ï¼ˆãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ãƒ»ç„¡æ–™ãƒ—ãƒ©ãƒ³ï¼‰
- **Cloudflare**ï¼ˆCDNãƒ»ç„¡æ–™ãƒ—ãƒ©ãƒ³ï¼‰
- **LINE Messaging API**ï¼ˆæœˆ1000é€šç„¡æ–™ï¼‰

### ç„¡æ–™æ åˆ¶é™ã¨å¯¾ç­–
| ã‚µãƒ¼ãƒ“ã‚¹ | åˆ¶é™ | å¯¾ç­– |
|---------|------|------|
| Supabase | 500MB DB | å¤ã„ãƒ‡ãƒ¼ã‚¿è‡ªå‹•å‰Šé™¤ï¼ˆ3ãƒ¶æœˆï¼‰ |
| Vercel | 100GBå¸¯åŸŸ | ç”»åƒåœ§ç¸®ãƒ»Service Workerã‚­ãƒ£ãƒƒã‚·ãƒ¥ |
| LINE API | 1000é€š/æœˆ | åŠ¹ç‡çš„ãªãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ³ã‚° |

## ğŸ“Š ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¨­è¨ˆï¼ˆPostgreSQLï¼‰

### ä¸»è¦ãƒ†ãƒ¼ãƒ–ãƒ«
```sql
-- ã‚¹ã‚¿ãƒƒãƒ•
CREATE TABLE staff (
  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
  staff_id TEXT UNIQUE NOT NULL,
  name TEXT NOT NULL,
  line_user_id TEXT UNIQUE,
  role TEXT DEFAULT 'STAFF' CHECK (role IN ('STAFF', 'MANAGER', 'ADMIN')),
  is_active BOOLEAN DEFAULT true,
  preferred_reminder_time TIME DEFAULT '18:00',
  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
  updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);

-- å ±å‘Šæ›¸ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ
CREATE TABLE report_templates (
  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
  title TEXT NOT NULL,
  description TEXT,
  frequency TEXT CHECK (frequency IN ('DAILY', 'WEEKLY', 'MONTHLY')),
  due_time TIME DEFAULT '18:00',
  reminder_message TEXT DEFAULT 'ãŠç–²ã‚Œã•ã¾ã§ã™ï¼å ±å‘Šæ›¸ã®æå‡ºã‚’ãŠé¡˜ã„ã—ã¾ã™ğŸ˜Š',
  is_active BOOLEAN DEFAULT true,
  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);

-- è³ªå•è¨­å®š
CREATE TABLE questions (
  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
  template_id UUID REFERENCES report_templates(id) ON DELETE CASCADE,
  text TEXT NOT NULL,
  type TEXT CHECK (type IN ('TEXT', 'TEXTAREA', 'CHOICE', 'SCALE_1_TO_5', 'YES_NO')),
  options TEXT[], -- JSONé…åˆ—
  is_required BOOLEAN DEFAULT false,
  "order" INT DEFAULT 0
);

-- æå‡ºå±¥æ­´
CREATE TABLE submissions (
  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
  report_id UUID REFERENCES report_templates(id),
  staff_id UUID REFERENCES staff(id),
  answers JSONB,
  mood TEXT CHECK (mood IN ('happy', 'neutral', 'need_help')),
  has_question BOOLEAN DEFAULT false,
  question TEXT,
  is_answered BOOLEAN DEFAULT false,
  admin_reply TEXT,
  replied_at TIMESTAMP WITH TIME ZONE,
  submitted_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);

-- ç›¸è«‡ãƒ»è³ªå•
CREATE TABLE consultations (
  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
  staff_id UUID REFERENCES staff(id),
  title TEXT NOT NULL,
  content TEXT NOT NULL,
  is_anonymous BOOLEAN DEFAULT false,
  status TEXT DEFAULT 'PENDING' CHECK (status IN ('PENDING', 'IN_PROGRESS', 'RESOLVED')),
  priority TEXT DEFAULT 'MEDIUM' CHECK (priority IN ('LOW', 'MEDIUM', 'HIGH', 'URGENT')),
  admin_reply TEXT,
  replied_at TIMESTAMP WITH TIME ZONE,
  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);

-- ã‚¢ãƒãƒ¼ãƒ–ãƒ¡ãƒ³ãƒˆ
CREATE TABLE achievements (
  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
  staff_id UUID REFERENCES staff(id),
  type TEXT NOT NULL,
  title TEXT NOT NULL,
  description TEXT,
  icon TEXT,
  earned_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);
```

### Row Level Security (RLS) è¨­å®š
```sql
-- ã‚¹ã‚¿ãƒƒãƒ•ã¯è‡ªåˆ†ã®ãƒ‡ãƒ¼ã‚¿ã®ã¿ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½
ALTER TABLE staff ENABLE ROW LEVEL SECURITY;
CREATE POLICY "staff_own_data" ON staff
  FOR ALL USING (auth.uid()::text = id::text);

-- ç®¡ç†è€…ã¯å…¨ãƒ‡ãƒ¼ã‚¿ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½
CREATE POLICY "admin_all_access" ON staff
  FOR ALL USING (
    EXISTS (
      SELECT 1 FROM staff 
      WHERE id::text = auth.uid()::text 
      AND role IN ('ADMIN', 'MANAGER')
    )
  );
```

## ğŸ¨ å¿ƒç†çš„å®‰å…¨æ€§é‡è¦–ã®UI/UXè¨­è¨ˆ

### ãƒ‡ã‚¶ã‚¤ãƒ³åŸå‰‡
1. **è¨€è‘‰é£ã„**
```typescript
// âŒ é¿ã‘ã‚‹ã¹ãè¡¨ç¾
"ç· åˆ‡: æœ¬æ—¥18:00ã€å³å®ˆã€‘"
"æœªæå‡ºã§ã™ã€‚è‡³æ€¥æå‡ºã—ã¦ãã ã•ã„ã€‚"
"ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ"

// âœ… æ¨å¥¨ã™ã‚‹è¡¨ç¾  
"ä»Šæ—¥ã®18:00é ƒãŒç›®å®‰ã§ã™ğŸ˜Š"
"ä½™è£•ãŒã‚ã‚‹ã¨ãã«æå‡ºã—ã¦ãã ã•ã„ã­"
"ã¡ã‚‡ã£ã¨èª¿å­ãŒæ‚ªã„ã¿ãŸã„ğŸ˜… ã‚‚ã†ä¸€åº¦è©¦ã—ã¦ã¿ã¦ãã ã•ã„"
```

2. **ã‚«ãƒ©ãƒ¼ãƒ‘ãƒ¬ãƒƒãƒˆ**
```css
:root {
  /* æš–è‰²ç³»ãƒ‘ã‚¹ãƒ†ãƒ«ã‚«ãƒ©ãƒ¼ */
  --primary: #FFE5E5;
  --secondary: #FFE5CC;
  --accent: #FF8C69;
  --text: #4A5568;
  --success: #68D391;
  --warning: #F6E05E;
}
```

3. **UIè¦ç´ **
- è§’ä¸¸ãƒ»ä½™ç™½ã‚’å¤šç”¨ã—ãŸå„ªã—ã„ãƒ‡ã‚¶ã‚¤ãƒ³
- çµµæ–‡å­—ã®ç©æ¥µçš„æ´»ç”¨
- ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã§æ¥½ã—ã•ã‚’æ¼”å‡º
- æˆåŠŸæ™‚ã¯å¤§ã’ã•ã«è¤’ã‚ã‚‹

### ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆè¨­è¨ˆä¾‹
```typescript
// å„ªã—ã„ãƒœã‚¿ãƒ³ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
interface GentleButtonProps {
  children: React.ReactNode
  variant: 'primary' | 'secondary' | 'later'
  onClick: () => void
  disabled?: boolean
}

const GentleButton: React.FC<GentleButtonProps> = ({ 
  children, 
  variant, 
  onClick, 
  disabled = false 
}) => {
  const variants = {
    primary: 'bg-orange-200 hover:bg-orange-300 text-orange-800',
    secondary: 'bg-blue-200 hover:bg-blue-300 text-blue-800',
    later: 'bg-gray-200 hover:bg-gray-300 text-gray-700'
  }
  
  return (
    <button 
      className={`px-6 py-3 rounded-xl font-medium transition-all ${variants[variant]} ${disabled ? 'opacity-50' : ''}`}
      onClick={onClick}
      disabled={disabled}
    >
      {children}
    </button>
  )
}
```

## ğŸ”§ ä¸»è¦æ©Ÿèƒ½ã®å®Ÿè£…è¦ä»¶

### 1. ã‚¹ã‚¿ãƒƒãƒ•å‘ã‘æ©Ÿèƒ½

#### å ±å‘Šæ›¸æå‡ºãƒ•ãƒ­ãƒ¼
```typescript
// 3ã¤ã®ãƒœã‚¿ãƒ³é¸æŠ
interface SubmissionChoice {
  type: 'submit' | 'consult' | 'later'
  message: string
  icon: string
}

const submissionChoices: SubmissionChoice[] = [
  { type: 'submit', message: 'æå‡ºå®Œäº†ï¼', icon: 'ğŸ“' },
  { type: 'consult', message: 'ç›¸è«‡ã—ãŸã„', icon: 'ğŸ’¬' },
  { type: 'later', message: 'å¾Œã§', icon: 'â°' }
]
```

#### æ°—åˆ†é¸æŠæ©Ÿèƒ½
```typescript
interface MoodOption {
  value: 'happy' | 'neutral' | 'need_help'
  label: string
  icon: string
  color: string
}

const moodOptions: MoodOption[] = [
  { value: 'happy', label: 'ä»Šæ—¥ã¯èª¿å­ã„ã„ã§ã™ï¼', icon: 'ğŸ˜Š', color: 'green' },
  { value: 'neutral', label: 'æ™®é€šã§ã™', icon: 'ğŸ˜', color: 'gray' },
  { value: 'need_help', label: 'ã¡ã‚‡ã£ã¨å¤§å¤‰ã‹ã‚‚', icon: 'ğŸ˜…', color: 'orange' }
]
```

#### ã‚¢ãƒãƒ¼ãƒ–ãƒ¡ãƒ³ãƒˆã‚·ã‚¹ãƒ†ãƒ 
```typescript
interface Achievement {
  id: string
  type: string
  title: string
  description: string
  icon: string
  points: number
}

const achievementTypes = {
  firstSubmit: { icon: "ğŸ‰", message: "åˆã‚ã¦ã®æå‡ºï¼", points: 10 },
  weekStreak: { icon: "ğŸ”¥", message: "1é€±é–“é€£ç¶šï¼", points: 50 },
  helpOthers: { icon: "ğŸ¤", message: "ãƒãƒ¼ãƒ ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ï¼", points: 30 },
  earlyBird: { icon: "ğŸŒ…", message: "æ—©èµ·ãã•ã‚“ï¼", points: 20 }
}
```

### 2. ç®¡ç†è€…å‘ã‘æ©Ÿèƒ½

#### å„ªå…ˆå¯¾å¿œãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰
```typescript
interface PriorityItem {
  type: 'QUESTION' | 'OVERDUE' | 'FIRST_TIME' | 'NEED_HELP'
  staffName: string
  content: string
  urgency: 'HIGH' | 'MEDIUM' | 'LOW'
  timestamp: string
  id: string
}

// å„ªå…ˆåº¦é †ã§ã‚½ãƒ¼ãƒˆ
const priorityOrder = ['QUESTION', 'NEED_HELP', 'FIRST_TIME', 'OVERDUE']
```

#### ãƒ¯ãƒ³ã‚¯ãƒªãƒƒã‚¯è¿”ä¿¡
```typescript
const quickReplyTemplates = {
  encouragement: [
    "ã„ã¤ã‚‚ãŠç–²ã‚Œã•ã¾ã§ã™ï¼é ‘å¼µã£ã¦ã¾ã™ã­ğŸ˜Š",
    "æå‡ºã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ï¼ã¨ã¦ã‚‚å‚è€ƒã«ãªã‚Šã¾ã—ãŸğŸ‘",
    "è³ªå•ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ã€‚ä¸€ç·’ã«è€ƒãˆã¾ã—ã‚‡ã†ğŸ’ª"
  ],
  support: [
    "ä½•ã‹å›°ã£ãŸã“ã¨ãŒã‚ã‚Œã°ã€ã„ã¤ã§ã‚‚ç›¸è«‡ã—ã¦ãã ã•ã„ã­",
    "ç„¡ç†ã—ãªã„ã§ãã ã•ã„ã­ã€‚ãƒãƒ¼ãƒ ã§ã‚µãƒãƒ¼ãƒˆã—ã¾ã™ğŸ¤",
    "ã„ã„ã‚¢ã‚¤ãƒ‡ã‚¢ã§ã™ã­ï¼ãœã²è©¦ã—ã¦ã¿ã¾ã—ã‚‡ã†âœ¨"
  ]
}
```

## ğŸ”„ Supabaseçµ±åˆå®Ÿè£…

### 1. Supabaseã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆè¨­å®š
```typescript
// lib/supabase.ts
import { createClient } from '@supabase/supabase-js'
import type { Database } from './database.types'

const supabaseUrl = import.meta.env.VITE_SUPABASE_URL
const supabaseAnonKey = import.meta.env.VITE_SUPABASE_ANON_KEY

export const supabase = createClient<Database>(supabaseUrl, supabaseAnonKey)

// èªè¨¼ãƒ•ãƒƒã‚¯
export const useAuth = () => {
  const [user, setUser] = useState(null)
  const [loading, setLoading] = useState(true)

  useEffect(() => {
    supabase.auth.getSession().then(({ data: { session } }) => {
      setUser(session?.user ?? null)
      setLoading(false)
    })

    const { data: { subscription } } = supabase.auth.onAuthStateChange(
      (_event, session) => {
        setUser(session?.user ?? null)
        setLoading(false)
      }
    )

    return () => subscription.unsubscribe()
  }, [])

  return { user, loading }
}
```

### 2. ãƒ‡ãƒ¼ã‚¿æ“ä½œä¾‹
```typescript
// å ±å‘Šæ›¸æå‡º
const submitReport = async (reportData: ReportSubmission) => {
  try {
    const { data, error } = await supabase
      .from('submissions')
      .insert({
        report_id: reportData.templateId,
        staff_id: user.id,
        answers: reportData.answers,
        mood: reportData.mood,
        has_question: reportData.hasQuestion,
        question: reportData.question
      })
      .select()

    if (error) throw error
    
    // æˆåŠŸæ™‚ã®åŠ±ã¾ã—ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
    toast.success('æå‡ºã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã—ãŸï¼ãŠç–²ã‚Œã•ã¾ã§ã—ãŸğŸ‰')
    
    // ã‚¢ãƒãƒ¼ãƒ–ãƒ¡ãƒ³ãƒˆãƒã‚§ãƒƒã‚¯
    await checkAchievements(user.id)
    
    return data
  } catch (error) {
    toast.error('å°‘ã—èª¿å­ãŒæ‚ªã„ã¿ãŸã„ğŸ˜… ã‚‚ã†ä¸€åº¦ãŠè©¦ã—ãã ã•ã„')
    console.error('Report submission error:', error)
  }
}

// ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ é€šçŸ¥
useEffect(() => {
  const subscription = supabase
    .channel('submissions')
    .on('postgres_changes', 
      { 
        event: 'INSERT', 
        schema: 'public', 
        table: 'submissions' 
      },
      (payload) => {
        toast.success('æ–°ã—ã„å ±å‘Šæ›¸ãŒæå‡ºã•ã‚Œã¾ã—ãŸï¼')
        // ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰æ›´æ–°
        queryClient.invalidateQueries(['dashboard'])
      }
    )
    .subscribe()

  return () => supabase.removeChannel(subscription)
}, [])
```

### 3. Edge Functionsä¾‹
```typescript
// supabase/functions/send-reminder/index.ts
import { serve } from 'https://deno.land/std@0.168.0/http/server.ts'
import { createClient } from 'https://esm.sh/@supabase/supabase-js@2'

serve(async (req) => {
  const supabase = createClient(
    Deno.env.get('SUPABASE_URL') ?? '',
    Deno.env.get('SUPABASE_SERVICE_ROLE_KEY') ?? ''
  )

  // å„ªã—ã„ãƒªãƒã‚¤ãƒ³ãƒ€ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ
  const reminderTemplates = {
    gentle: "ã“ã‚“ã«ã¡ã¯ğŸ˜Š {reportName}ã®æå‡ºã€ãŠæ™‚é–“ã‚ã‚‹ã¨ãã«ãŠé¡˜ã„ã—ã¾ã™",
    veryGentle: "ãŠç–²ã‚Œã•ã¾ã§ã™â˜• {reportName}ã€ä»Šæ—¥ä¸­ã§å¤§ä¸ˆå¤«ã§ã™ã‚ˆã€œ",
    supportive: "å¿™ã—ã„ã¨æ€ã„ã¾ã™ãŒã€{reportName}ã‚ˆã‚ã—ããŠé¡˜ã„ã—ã¾ã™ğŸ’ª"
  }

  // ã‚¹ã‚¿ãƒƒãƒ•ä¸€è¦§å–å¾—
  const { data: staff } = await supabase
    .from('staff')
    .select('*')
    .eq('is_active', true)

  // LINE Messaging APIçµŒç”±ã§ãƒªãƒã‚¤ãƒ³ãƒ€ãƒ¼é€ä¿¡
  for (const s of staff || []) {
    if (s.line_user_id) {
      await sendLineMessage(s.line_user_id, reminderTemplates.gentle)
    }
  }

  return new Response(JSON.stringify({ success: true }), {
    headers: { 'Content-Type': 'application/json' }
  })
})
```

## ğŸ“± PWAå®Ÿè£…è¦ä»¶

### Service Workerè¨­å®š
```typescript
// vite.config.ts
import { VitePWA } from 'vite-plugin-pwa'

export default defineConfig({
  plugins: [
    react(),
    VitePWA({
      registerType: 'autoUpdate',
      workbox: {
        globPatterns: ['**/*.{js,css,html,ico,png,svg,woff2}'],
        runtimeCaching: [
          {
            urlPattern: /^https:\/\/.*\.supabase\.co\/rest\/v1\/.*/i,
            handler: 'NetworkFirst',
            options: {
              cacheName: 'supabase-api',
              networkTimeoutSeconds: 10,
              cacheableResponse: {
                statuses: [0, 200]
              }
            }
          }
        ]
      },
      manifest: {
        name: 'RepoTomo',
        short_name: 'ãƒ¬ãƒãƒ¼ãƒˆãƒ¢',
        description: 'å¿ƒç†çš„å®‰å…¨æ€§ã‚’é‡è¦–ã—ãŸå ±å‘Šæ›¸ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ',
        theme_color: '#FF8C69',
        background_color: '#FFE5E5',
        display: 'standalone',
        scope: '/',
        start_url: '/',
        icons: [
          {
            src: '/icon-192.png',
            sizes: '192x192',
            type: 'image/png'
          },
          {
            src: '/icon-512.png',
            sizes: '512x512',
            type: 'image/png'
          }
        ]
      }
    })
  ]
})
```

### ã‚ªãƒ•ãƒ©ã‚¤ãƒ³æ©Ÿèƒ½
```typescript
// hooks/useOfflineSync.ts
export const useOfflineSync = () => {
  const [isOnline, setIsOnline] = useState(navigator.onLine)
  const [pendingSubmissions, setPendingSubmissions] = useState([])

  useEffect(() => {
    const handleOnline = async () => {
      setIsOnline(true)
      // ã‚ªãƒ•ãƒ©ã‚¤ãƒ³ä¸­ã®æŠ•ç¨¿ã‚’åŒæœŸ
      for (const submission of pendingSubmissions) {
        try {
          await supabase.from('submissions').insert(submission)
          setPendingSubmissions(prev => 
            prev.filter(p => p.tempId !== submission.tempId)
          )
          toast.success('ã‚ªãƒ•ãƒ©ã‚¤ãƒ³ä¸­ã®å ±å‘Šæ›¸ã‚’åŒæœŸã—ã¾ã—ãŸï¼')
        } catch (error) {
          console.error('åŒæœŸã‚¨ãƒ©ãƒ¼:', error)
        }
      }
    }

    const handleOffline = () => {
      setIsOnline(false)
      toast.info('ã‚ªãƒ•ãƒ©ã‚¤ãƒ³ãƒ¢ãƒ¼ãƒ‰ã§ã™ã€‚ã‚ªãƒ³ãƒ©ã‚¤ãƒ³å¾©å¸°æ™‚ã«è‡ªå‹•åŒæœŸã—ã¾ã™')
    }

    window.addEventListener('online', handleOnline)
    window.addEventListener('offline', handleOffline)

    return () => {
      window.removeEventListener('online', handleOnline)
      window.removeEventListener('offline', handleOffline)
    }
  }, [pendingSubmissions])

  return { isOnline, pendingSubmissions, setPendingSubmissions }
}
```

## ğŸš€ ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ»é‹ç”¨

### ç’°å¢ƒå¤‰æ•°
```bash
# .env.local
VITE_SUPABASE_URL=https://your-project.supabase.co
VITE_SUPABASE_ANON_KEY=your-anon-key
VITE_LINE_CHANNEL_ID=your-line-channel-id
VITE_ENVIRONMENT=development
```

### ãƒ‡ãƒ—ãƒ­ã‚¤ã‚³ãƒãƒ³ãƒ‰
```bash
# Vercelãƒ‡ãƒ—ãƒ­ã‚¤
vercel env add VITE_SUPABASE_URL
vercel env add VITE_SUPABASE_ANON_KEY
vercel --prod

# Supabaseãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
supabase db push --linked
```

### ç›£è¦–é …ç›®
```typescript
// ç„¡æ–™æ ä½¿ç”¨é‡ç›£è¦–
const monitoringMetrics = {
  supabase: {
    databaseSize: '500MBä»¥å†…',
    monthlyActiveUsers: '50,000ä»¥å†…',
    storageUsage: '1GBä»¥å†…'
  },
  vercel: {
    bandwidth: '100GBä»¥å†…',
    buildMinutes: '6,000åˆ†ä»¥å†…'
  },
  line: {
    monthlyMessages: '1,000é€šä»¥å†…'
  }
}
```

## ğŸ¯ æˆåŠŸæŒ‡æ¨™ãƒ»KPI

```typescript
const successMetrics = {
  submissionRate: 0.9,        // 90%ä»¥ä¸Š
  userSatisfaction: 4.0,      // 5æ®µéšè©•ä¾¡
  questionResponseTime: 180,   // 3æ™‚é–“ä»¥å†…ï¼ˆåˆ†ï¼‰
  stressLevel: "low",         // å®šæ€§è©•ä¾¡
  monthlyCost: 0,             // æœˆé¡0å††ç¶­æŒ
  appLoadTime: 2.0,           // 2ç§’ä»¥å†…
  offlineCapability: true     // ã‚ªãƒ•ãƒ©ã‚¤ãƒ³å¯¾å¿œ
}
```

## ğŸ“‹ å®Ÿè£…å„ªå…ˆé †ä½

### Phase 1: MVPï¼ˆ2é€±é–“ï¼‰
1. Supabaseç’°å¢ƒæ§‹ç¯‰
2. æ—¢å­˜React UIã‚’Supabaseçµ±åˆ
3. åŸºæœ¬çš„ãªå ±å‘Šæ›¸æå‡ºæ©Ÿèƒ½
4. ç®¡ç†è€…ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰åŸºæœ¬æ©Ÿèƒ½

### Phase 2: PWAåŒ–ï¼ˆ1é€±é–“ï¼‰
1. Service Workerå®Ÿè£…
2. ã‚ªãƒ•ãƒ©ã‚¤ãƒ³æ©Ÿèƒ½
3. ãƒ—ãƒƒã‚·ãƒ¥é€šçŸ¥

### Phase 3: é«˜åº¦æ©Ÿèƒ½ï¼ˆ1é€±é–“ï¼‰
1. ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ é€šçŸ¥
2. ã‚¢ãƒãƒ¼ãƒ–ãƒ¡ãƒ³ãƒˆã‚·ã‚¹ãƒ†ãƒ 
3. è©³ç´°åˆ†ææ©Ÿèƒ½

## ğŸ›¡ï¸ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è¦ä»¶

- Supabase RLSè¨­å®š
- JWTèªè¨¼
- XSS/CSRFå¯¾ç­–
- å…¥åŠ›å€¤æ¤œè¨¼
- ç’°å¢ƒå¤‰æ•°ç®¡ç†

## ğŸ’¡ é–‹ç™ºæ™‚ã®æ³¨æ„ç‚¹

### DO's âœ…
- ã‚¹ã‚¿ãƒƒãƒ•ã®æ°—æŒã¡ã«å¯„ã‚Šæ·»ã†å®Ÿè£…
- å¤±æ•—ã‚’æã‚Œã•ã›ãªã„è¨­è¨ˆ
- å°ã•ãªæˆåŠŸã‚’å¤§ããè¤’ã‚ã‚‹
- ç„¡æ–™æ ã‚’è¶…ãˆãªã„ã‚ˆã†ç›£è¦–

### DON'Ts âŒ
- å¨åœ§çš„ãƒ»å‘½ä»¤çš„ãªè¡¨ç¾
- èµ¤æ–‡å­—ã§ã®è­¦å‘Šè¡¨ç¤º
- ã‚«ã‚¦ãƒ³ãƒˆãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒãƒ¼
- ã‚³ã‚¹ãƒˆç™ºç”Ÿã®å¯èƒ½æ€§ãŒã‚ã‚‹æ“ä½œ

---

ğŸ’¡ **é–‹ç™ºã®ãƒ¢ãƒƒãƒˆãƒ¼**: ã€Œæœˆé¡0å††ã§ã€ã‚¹ã‚¿ãƒƒãƒ•ãŒè‡ªç„¶ã«å ±å‘Šã—ãŸããªã‚‹ã‚·ã‚¹ãƒ†ãƒ ã€